# Дообучение TinyLlama с помощью LoRA на теме «Электроника»

## 1. Используемая модель и параметры

### Базовая модель
- **Название**: `TinyLlama/TinyLlama-1.1B-Chat-v1.0`
- **Тип**: Causal Language Model (чат-ориентированная)
- **Размер**: ~1.1 млрд параметров
- **Источник**: HuggingFace Transformers

### Квантование
- Используется **4-битная загрузка** модели:
  - `load_in_4bit=True` при обучении
  - `BitsAndBytesConfig(load_in_4bit=True)` при инференсе
- Тип вычислений: `float16`

---

## 2. Параметры обучения
Из файла `train_model.py`
### Конфигурация LoRA
```python
lora_config = LoraConfig(
    r=16,
    lora_alpha=32,
    lora_dropout=0.05,
    target_modules=["q_proj", "k_proj", "v_proj", "o_proj"],
    bias="none",
    task_type="CAUSAL_LM",
)

model = get_peft_model(model, lora_config)
```
### Параметры обучения
```python
training_args = TrainingArguments(
    output_dir=args.output_dir,
    per_device_train_batch_size=2,
    per_device_eval_batch_size=2,
    gradient_accumulation_steps=4,
    num_train_epochs=5,
    learning_rate=2e-4,
    fp16=True,
    logging_steps=2,
    logging_first_step=True,
    save_steps=200,
    eval_strategy="steps",
    eval_steps=100,
    save_total_limit=2,
    load_best_model_at_end=True,
    report_to="none",
    optim="paged_adamw_8bit",
)
```

### Обучение модели
```python
trainer = Trainer(
    model=model,
    args=training_args,
    train_dataset=tokenized_train,
    eval_dataset=tokenized_eval,
    data_collator=collator,
)

trainer.train()
```
---

## 3. Данные обучения (тема: электроника)
**Источник данных**
- **Файл:** dataset.csv
- **Формат:**
  - question
  - answer
 
### Пример строки из датасета
Что такое резистор?,"Резистор — это пассивный компонент, ограничивающий ток в электрической цепи. Его сопротивление измеряется в омах по закону Ома: U = I × R. Используется для задания рабочих режимов, делителей напряжения, ограничения тока."
    
Каждая строка преобразуется в чат-промпт:
```
<|user|>
Вопрос</s>
<|assistant|>
Ответ</s>
```
Размер датасета 125 строк
- Разделение:
  - 80% для обучения
  - 20 для валидации

## **Примеры запросов и ответов на тему «Электроника»**
### Без использования LoRA
```
Вы: Что такое резистор?
Модель: <|user|>
Что такое резистор? 
<|assistant|>
A reactor or reactive (from the Latin root rex) is a device that can generate electricity 
from the heat generated by heat exchangers that contain a fluid that absorbs and reabsorbs the energy. The fluid is usually a liquid such as water or oil, and the temperature gradient inside the fluid generates the heat. The reactor is typically used in steam generators, where the fluid is heated by steam passing through the heater, allowing the fluid to absorb energy and heat the reactor. The heat generated by the heater is then absorbed by a reactive fluid, which is typically a solvent that can absorb and reabsorb energy, and convert it into electricity. By absorbing and reabsorbing the energy, the reactor or reactive fluid creates electricity that can be used to generate electricity.
```

```  
Вы: что такое оптопара?  

Модель: <|user|>
что такое оптопара?
<|assistant|>
Оптопара (Оптопара) — это системы, использующие оптические каналы (например, видимость колебаний в оптовом зоне) для наблюдения за движением вещей, схожих с водными опанами. В оптопаре используются специальные оптические каналы, например, светильники, что позволяет определить движение в определённых границах, например, в области опитки и водных опанок. В оптопаре используются также оптические каналы для определения смешений и других состояний наблюдаемой вещей, например, в случаях, когда вещество не перемещается в водные опаны.       
```

### С использованием LoRA
```
Вы: Что такое резистор?

Модель: <|user|>
Что такое резистор?
<|assistant|>
Резистор — это элементы электроники, предназначенные для сопротивления потоку теплоти, электрически изключающему источник питания. Резисторы сопоставляют напряжение, снижающее его, тем охлаждающему. Применяются для усиления питания электронных элементов, например, наночаршек. Очень распространён в электромеханике (агентство «Компьютер-Схема» производит 10 миллионов резисторов). Пример: 100 Ω. (Source: "Электронный машинобудуктор", ГП «Компьютер-Схема», 2014). Комбинатор (конструкция) резисторов:
```

```
Вы: что такое оптопара? 

Модель: <|user|>
что такое оптопара?
<|assistant|>
оптопара — это набор из светодиодов, обеспечивающих полное или частичное излучение, зависимость от света, пропускной способность, настойчивый спаринг, навигация по световым сведениям, определение времени и даты, квазимикросхемами (микросхема на основе оптико-магнитофоновых наглоуходных переменных). Конструктивные особенности: сверходят на основе полупрозрачных (сверхоптический) или сверхоптически-прозрачных (макрохибный) фотоэлементов. Примеры: светодиоды, фотоэлементы, микросхемы. Примеры: светодиоды (дет
```
